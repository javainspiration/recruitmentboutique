<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Barlow:wght@100;400&display=swap" rel="stylesheet">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css"
        integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/all.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.14.0/css/v4-shims.css">
    <link rel="stylesheet" href="assets/css/styles.css">
    <title>Recruitment Boutique | Vacancy</title>
    <style>
        .btn:not(:disabled):not(.disabled) {
            color: #27A5F0;
        }
        table tr{
            vertical-align: top;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="row">
            <div class="col-md-3" style="padding: 30px; height: 100vh;">
                <div>
                    <div class="nav flex-column nav-pills" style="color: #4D4D4D;" id="v-pills-tab" role="tablist"
                        aria-orientation="vertical">
                        <div class="text-center mb-4">
                            <img src="assets/images/logo.png" class="img-fluid" width="40%" alt="" style="padding: 0">
                        </div>
                        <div style="background-color: #27A5F0; border-radius: 10px;color: #fff;padding: 5px 15px;">
                            <h5 class="mt-2">Credits </h5>
                            <h2 style="font-weight: bold;" id="total-credits"></h2>
                        </div>
                        <div class="mb-4 mt-3">
                            <a style="text-decoration: none;" href="top-up.html">
                                <button class="btn btn-outline-primary"
                                    style="background-color: #F2F3F4; border-radius: 10px; float: right; padding: 5px 20px;">
                                    Top Up
                                </button>
                            </a>
                        </div>
                        <a class="nav-link" href="dashboard.html" style="color: #4D4D4D;"><img
                                src="assets/images/home-outline-variant.svg" class="mr-2"
                                style="margin-top: -5px;" />Dashboard</a>
                        <a class="nav-link active" href="vacancy-search.html" data-toggle="pill" aria-controls="v-pills-settings"
                            aria-selected="true" role="tab" href="#"><i class="far fa-user mr-2"
                                style="font-size: 18px;"></i>Vacancy</a>
                        <a class="nav-link" style="color: #4D4D4D;" href="support.html" role="tab"><img
                                src="assets/images/customer-agent.svg" class="mr-2"
                                style="margin-top: -5px;" />Support</a>
                        <a class="nav-link" role="tab" style="color: #4D4D4D;" href=" settings.html"><img
                                src="assets/images/settings.svg" class="mr-2" style="margin-top: -5px;" />Settings</a>
                        <div class="mb-4" style="bottom: 0;margin-top: 100px;text-align: center;">
                            <a style="text-decoration: none;" href="index.html">
                                <button class="btn" style="background-color: #F2F3F4; border-radius: 10px;width: 100%;">
                                    <img src="assets/images/sign-out.svg" class="mr-2" />
                                    <span style="color: #27A5F0">Sign Out</span>
                                </button>
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-9" style="background-color: #F2F3F4;height: 100vh;overflow-x: hidden;padding: 0;">
                <div class="tab-content" id="v-pills-tabContent">
                    <div class="tab-pane fade show active" id="v-pills-support" role="tabpanel"
                        aria-labelledby="v-pills-support-tab">
                        <div style="background-color: rgba(213, 239, 247, 0.5);height: 150px;">
                            <div class="row" style="padding: 10px;">
                                <div class="col-md-2 mt-3 ml-5">
                                    <img src="assets/images/home-outline-variant-blue.svg"
                                        style="margin-right: 10px;display: none" />
                                    <img src="assets/images/magnifying-glass.svg" style="display: none;" />
                                </div>
                                <div class="col-md-5"></div>
                                <div class="col-md-1 mt-3">
                                    <img src="assets/images/bell.svg" style="display: none;" />
                                </div>
                                <div class="col-md-3 mt-2"
                                    style="background-color:rgba(255, 255, 255, 0.5);border-radius: 10px;">
                                    <div class="row" style="margin-top: 10px;padding: 0 10px;">
                                        <div class="mr-2"
                                            style="background-color: rgba(79, 79, 79, 1); border-radius: 50px; height: 30px;width: 30px;">
                                        </div>
                                        <p style="margin-top: 2px;" class="profile-name"></p>
                                    </div>
                                </div>
                                <div class="col-md-1"></div>
                            </div>
                        </div>
                        <div style="padding: 0 50px;margin-top: -50px;">
                            <div
                                style="background: linear-gradient(to right, #B9D8EC 20%, #E8EFF4);border-radius: 10px;">
                                <div class="row" style="padding: 20px;">
                                    <div class="col-md-9" style="padding: 0 20px;">
                                        <br/>
                                        <h2 id="vacancy-title" style="color: #fff;font-weight: bold;margin-top: -5px;">...</h2>
                                        <p id="vacancy-location" style="color: #fff;"></p>
                                    </div>
                                    <div class="col-md-3">
                                        <img src="assets/images/Job-hunt-rafiki.svg" width="80%"
                                            style="margin-left: -20px;" />
                                        <a style="text-decoration: none; color: #27A5F0;" href="vacancy-create.html">
                                            <button data-toggle="modal" data-target="#exampleModalCenter" type="button"
                                                class="btn btn-outline-primary"
                                                style="position:relative;background-color: #F2F3F4; border-radius: 10px; float: right; padding: 0x 20px;margin-top: -50px;">
                                                <span style="font-size: 14px;">+ NEW VACANCY</span>
                                            </button>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div style="padding: 50px;">
                    <h3 style="font-weight: bold;">Candidates</h3>
                    <div class="row">
                        <div class="col-md-12">
                            <!-- <div class="row mt-4"> -->
                                <!-- <p class="ml-4 mr-4 mt-1">From</p>
                                <div class="dropdown show">
                                    <a class="btn btn-secondary dropdown-toggle" style="background-color: #fff;" href="#"
                                        role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        4 August 2020
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                        <a class="dropdown-item" href="#">4 August 2020</a>
                                        <a class="dropdown-item" href="#">5 August 2020</a>
                                        <a class="dropdown-item" href="#">6 August 2020</a>
                                    </div>
                                </div>
                                <p class="ml-4 mr-4 mt-1">To</p>
                                <div class="dropdown show">
                                    <a class="btn btn-secondary dropdown-toggle" style="background-color: #fff;" href="#"
                                        role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="true"
                                        aria-expanded="false">
                                        10 October 2020
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="dropdownMenuLink">
                                        <a class="dropdown-item" href="#">10 October 2020</a>
                                        <a class="dropdown-item" href="#">11 October 2020</a>
                                        <a class="dropdown-item" href="#">12 October 2020</a>
                                    </div>
                                </div> -->
                                <div class="input-group mb-3 ml-5" style="width: 40%;float:right;">
                                    <input type="text" class="form-control search" placeholder="">
                                    <div class="input-group-append">
                                        <span class="input-group-text" style="background-color: white;"><img
                                                src="assets/images/magnifying-glass.svg"/></span>
                                    </div>
                                </div>
                            <!-- </div> -->
                        </div>
                    </div>

                    <table id="vacancies-data" style="width: 100%;">
                        <tr style="color: #27A5F0;">
                            <th style="padding: 10px;">No</th>
                            <th style="padding: 10px;">Candidate</th>
                            <th style="padding: 10px;">Submit Date</th>
                            <th style="padding: 10px;"></th>
                        </tr>
                    </table>
                    <!--footer-->
                    <div class="container">
                        <div class="container text-center" style="padding: 25px;color: #27A5F0;">
                            <div style="padding: 50px;">
                                <p style="font-weight: 600;"><a style="text-decoration: none;color: #27A5F0;"
                                        href="term.html">Terms & Conditions </a><span style="margin: 0 20px;">|</span>
                                    <a style="text-decoration: none;color: #27A5F0;" href="privacy.html">Privacy
                                        Policy</a></p>
                                <p>O.T.C.S. is registered in England and Wales | It’s Company Registration Number is
                                    11444931 <br>
                                    Designed and built by Java Inspiration www.javainspiration.com <br>
                                    ©2020 Recruitment Boutique</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    <div id="cv-frame" style="position: fixed;top:0px;left:0px;width:100%;height: 100%;background:rgba(255, 255, 255, 0.4);display: none;">
        <div class="container" style="height:100%;">
            <div class="row" style="margin-top:100px;position: relative;color:#000;text-shadow: 0 0 10px #333">
                <div class="col-2 prev-candidate">
                    Previous Candidate
                </div>
                <div class="col-2 next-candidate">
                    Next Candidate
                </div>
                <div id="close-cv-frame" style="position: absolute;top:-20px; right:10px;width:30px;height:30px;padding-top:1px; text-align: center;background:#000;color:#FFF;border-radius: 50%;font-weight: 600;cursor: pointer;">
                        x
                </div>
            </div>
            <div class="row" style="height: 70%;">
                <div class="col" style="position: relative;">
                    <iframe id="cv-file" src="" style="width: 100%;height:100%;border:solid 1px #CCC;"></iframe>
                </div>
            </div>
        </div>
    </div>

    <div class="modal" id="commentcandidates">
        <div class="modal-dialog">
            <div class="modal-content" style="line-height: 25px;">
                <div class="modal-header">
                    <h3>Feedback</h3>
                </div>
                <form method="post" id="feedback-form">
                    <div class="modal-body">
                        How closely did this candidate meet your requirement?<br/>
                        <div>
                            <input type="radio" name="rate" value="rejected" /> Rejected<br/>
                            <input type="radio" name="rate" value="not at all" /> Not at all<br/>
                            <input type="radio" name="rate" value="nearly" /> Nearly<br/>
                            <input type="radio" name="rate" value="worth considering"/> Worth Considering<br/>
                            <input type="radio" name="rate" value="spot on"/> Spot On
                        </div>
                        <br/>
                        <div>
                            <h3>Comments</h3>
                            You may add additional comment here<br/>
                            <textarea class="form-control candidate-comment" name="comments"></textarea>
                        </div>
                    </div>
                </form>
                <div class="modal-footer">
                    <div class="btn btn-primary submitfeedback" style="color: #FFF">
                        Save
                    </div>
                    <div class="btn btn-secondary dismiss-buttom" data-dismiss="modal" style="color:#FFF;">
                        Cancel
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>

    <script>
        $(function() {
            var url = window.location.href.split('?id=');
            var vacancyId = url[1].replace('#', '');
            var candidates = [];
            var currentIndex = 0;
            var commentCandidates = [];
            var commentCandidate = {};

            $('#close-cv-frame').click(function(){
                $('#cv-frame').fadeOut();
                return false;
            });

            $('.prev-candidate').click(function(){
                currentIndex -= 1;
                if (currentIndex <= 0) {
                    currentIndex = 0;
                }
                $('#cv-frame iframe').attr('src', 'https://docs.google.com/viewer?url=https://recruitment-boutique.com/upl_cv/'+candidates[currentIndex].filename+'&embedded=true');
            });

            $('.next-candidate').click(function(){
                currentIndex += 1;
                if (currentIndex > candidates.length -1) {
                    currentIndex = candidates.length - 1;
                }
                $('#cv-frame iframe').attr('src', 'https://docs.google.com/viewer?url=https://recruitment-boutique.com/upl_cv/'+candidates[currentIndex].filename+'&embedded=true');
            });

            $('.submitfeedback').click(function(){
                commentCandidate.comments = $('.candidate-comment').val();
                commentCandidate.userid = localStorage.getItem('8dd4b3c8');
                commentCandidate.status = 'unread';
                commentCandidate.rate = $('[name="rate"]').val();

                $.ajax({
                    url: 'api/route.php?path=newComment',
                    headers:{
                        'PAGE':'commentcandidates',
                        'AUTH': localStorage.getItem('bd1f264d')
                    },
                    type: 'POST',
                    data: commentCandidate,
                    beforeSend: function(){
                        $('.submitfeedback').text('Submitting...');
                    },
                    success: function(){
                        $('.dismiss-buttom').click();
                    }
                });
                return false;
            });

            $.ajax({
                url : 'api/route.php',
                type : 'POST',
                headers: {
                    'PAGE': 'candidates',
                    'AUTH': 'ee349ed1674d47c17d052b101cf519cf'
                },
                data: {
                    vacancyid: vacancyId,
                    username: 'jocic'
                },
                success: function(res) {
                    if (res.data) {
                        candidates = res.data;
                        $.each(res.data, function(index, vac) {
                            $('#vacancies-data').append('<tr class="data" style="background-color:rgba(213, 239, 247, 0.3);font-size: 14px;">\
                            <td style="padding: 10px;">'+(index*1+1)+'</td>\
                            <td style="padding: 10px;">'+vac.candidatename+'<br/>'+vac.email+'<br/>'+vac.phone+'</td>\
                            <td style="padding: 10px;">'+vac.submitdate+'</td>\
                            <td style="padding: 10px;font-weight: bold;">\
                                <div style="text-decoration: none;display:inline;" href="vacancy-create.html">\
                                    <div class="preview" data-file="'+vac.filename+'" style="font-weight: normal; background-color: #27A5F0;color: #fff;border-radius: 10px;text-align:center;display:inline;padding:5px 10px;margin:0 5px 0 0;">\
                                        PREVIEW\
                                    </div>\
                                </div>\
                                <div style="text-decoration: none;display:inline;cursor:pointer;" class="dropdown">\
                                    <div data-toggle="dropdown" style="font-weight: normal; background-color: #27A5F0;color: #fff;border-radius: 10px;text-align:center;display:inline;padding:5px 10px;">\
                                        ... &#9660;\
                                    </div>\
                                    <div class="dropdown-menu"> \
                                        <a class="dropdown-item" href="https://recruitment-boutique.com/upl_cv/'+vac.filename+'">Download</a> \
                                        <a class="dropdown-item give-feedback" data-candidateid="'+vac.id+'" href="#" data-toggle="modal" data-target="#commentcandidates">Rate</a> \
                                        <a class="dropdown-item" href="#">Send to email</a> \
                                    </div> \
                                </div>\
                            </td>\
                        </tr>');
                        });

                        $('.preview').click(function(){
                            $('#cv-frame iframe').attr('src', 'https://docs.google.com/viewer?url=https://recruitment-boutique.com/upl_cv/'+$(this).attr('data-file')+'&embedded=true');
                            $('#cv-frame').fadeIn();
                            currentIndex = $(this).index();
                            return false;
                        });

                        $('.give-feedback').click(function(){
                            commentCandidate.candidateid = $(this).attr('data-candidateid');
                            getCommentCandidate($(this).attr('data-candidateid'));
                        });
                    }
                }
            });

            $.ajax({
                url : 'api/route.php',
                type : 'POST',
                headers: {
                    'PAGE': 'vacancies',
                    'AUTH': 'ee349ed1674d47c17d052b101cf519cf'
                },
                data: {
                    id: vacancyId
                },
                success: function(res) {
                    if (res.data) {
                        var vacancyData = res.data[0];
                        $('#vacancy-title').text(vacancyData.jobtitle);
                        $('#vacancy-location').text(vacancyData.clientref+' - '+vacancyData.location);
                    }
                }
            });

            function getCommentCandidate(candidateId) {
                $.ajax({
                    url : 'api/route.php',
                    type : 'POST',
                    headers: {
                        'PAGE': 'commentcandidates',
                        'AUTH': 'ee349ed1674d47c17d052b101cf519cf'
                    },
                    data: {
                        candidateid: candidateId,
                    },
                    success: function(res) {
                        if (res.data) {
                            commentCandidates = res.data;
                        }
                    }
                });
            }

            $('.search').keyup(function(){
                                var keyword = $(this).val().toLowerCase();

                                if (keyword.length > 2) {
                                    $('#vacancies-data .data').hide();

                                    $.each($('#vacancies-data .data'), function(index, val){
                                        if ($(this).text().toLowerCase().indexOf(keyword) > -1) {
                                            $('#vacancies-data .data').eq(index).show();
                                        }
                                    });
                                } else {
                                    $('#vacancies-data .data').show();
                                }
                            });

            $.ajax({
                url: 'api/route.php',
                type: 'GET',
                headers: {
                    'PAGE': 'profile',
                    'AUTH': localStorage.getItem('bd1f264d')
                },
                success: function(res) {
                    $('.profile-name').text(res[0].name);
                    $('.profile-name').text(res[0].name);
                }
            });;

            $.ajax({
                url : 'api/route.php',
                type : 'GET',
                dataType : 'json',
                headers: {
                    'PAGE': 'dashboard',
                    //'AUTH': 'ee349ed1674d47c17d052b101cf519cf'
                    'AUTH': localStorage.getItem('bd1f264d')
                },
                success: function(res) {
                    if (res.data) {
                        $('#total-credits').html(res.data.totalCredits+' Credits');
                    }
                }
            });
        })
    </script>
</body>

</html>